# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Piper TTS - –ì–æ—Ç–æ–≤–æ! üéâ

## –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. TTS –°–µ—Ä–≤–∏—Å (Piper TTS)
- ‚úÖ –†—É—Å—Å–∫–∞—è –º–æ–¥–µ–ª—å –≥–æ–ª–æ—Å–∞ `ru_RU-ruslan-medium`
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—É–¥–∏–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ API
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ (MIT License, open source)

### 2. API Endpoints
- `POST /api/tts/generate` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ–ª–æ—Å–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞
- `GET /api/tts/files` - —Å–ø–∏—Å–æ–∫ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- `GET /api/tts/audio/{filename}` - —Å–∫–∞—á–∞—Ç—å –∞—É–¥–∏–æ —Ñ–∞–π–ª
- `GET /api/tts/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ TTS —Å–µ—Ä–≤–∏—Å–∞

### 3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥–æ–ª–æ—Å–∞" –≤ –º–µ–Ω—é
- ‚úÖ –§–æ—Ä–º–∞ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –°—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ê—É–¥–∏–æ –ø–ª–µ–µ—Ä –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è
- ‚úÖ –°–ø–∏—Å–æ–∫ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Docker

–û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–∞ Mac –∏ –ø–µ—Ä–µ–π–¥–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cd ~/Downloads/123-claude-phone-campaign-system-0JRfL-2
```

–û—Å—Ç–∞–Ω–æ–≤–∏ —Ç–µ–∫—É—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker compose down
```

–ó–∞–ø—É—Å—Ç–∏ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π (–¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ TTS —Å–µ—Ä–≤–∏—Å–∞):

```bash
docker compose up --build -d
```

**–í–∞–∂–Ω–æ:** –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–π–º–µ—Ç ~3-5 –º–∏–Ω—É—Ç, —Ç.–∫. –±—É–¥–µ—Ç:
- –°–∫–∞—á–∏–≤–∞—Ç—å—Å—è Piper TTS (~10 MB)
- –°–∫–∞—á–∏–≤–∞—Ç—å—Å—è —Ä—É—Å—Å–∫–∞—è –º–æ–¥–µ–ª—å –≥–æ–ª–æ—Å–∞ (~100 MB)
- –°–æ–±–∏—Ä–∞—Ç—å—Å—è –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

–ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å:

```bash
docker compose ps
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã 4 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
- `phone-asterisk`
- `phone-postgres`
- `phone-campaign-manager`
- `phone-tts` ‚Üê –Ω–æ–≤—ã–π!

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TTS

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π http://localhost:8000
2. –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –Ω–∞–∂–º–∏ **"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥–æ–ª–æ—Å–∞"**
3. –í–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–∫–∞–∂–∏ –∏–º—è —Ñ–∞–π–ª–∞
5. –ù–∞–∂–º–∏ **"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–æ–ª–æ—Å"**
6. –ü—Ä–æ—Å–ª—É—à–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–ª–µ–µ—Ä–µ

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ API

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ–ª–æ—Å–∞
curl -X POST http://localhost:8000/api/tts/generate \
  -H "Content-Type: application/json" \
  -d '{
    "text": "–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–æ–±–∑–≤–æ–Ω–∞.",
    "filename": "test_message"
  }'

# –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
curl http://localhost:8000/api/tts/files

# –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
curl http://localhost:8000/api/tts/audio/test_message.wav -o test.wav
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏

**–¢–µ–∫—Å—Ç:**
```
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –≤–∞—à–µ–º –≤–∏–∑–∏—Ç–µ.
–ñ–¥–µ–º –≤–∞—Å –∑–∞–≤—Ç—Ä–∞ –≤ 15:00. –°–ø–∞—Å–∏–±–æ!
```

**–§–∞–π–ª:** `reminder.wav`

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞–º–ø–∞–Ω–∏–∏:
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞–º–ø–∞–Ω–∏–∏ —É–∫–∞–∂–∏ `audio_file: reminder.wav`

### –ü—Ä–∏–º–µ—Ä 2: –ú–∞—Å—Å–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

```bash
# –°–æ–æ–±—â–µ–Ω–∏–µ 1
curl -X POST http://localhost:8000/api/tts/generate \
  -H "Content-Type: application/json" \
  -d '{"text": "–í–∞—à –∑–∞–∫–∞–∑ –≥–æ—Ç–æ–≤ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é", "filename": "order_ready"}'

# –°–æ–æ–±—â–µ–Ω–∏–µ 2
curl -X POST http://localhost:8000/api/tts/generate \
  -H "Content-Type: application/json" \
  -d '{"text": "–ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –≤—Å—Ç—Ä–µ—á–µ", "filename": "meeting_reminder"}'

# –°–æ–æ–±—â–µ–Ω–∏–µ 3
curl -X POST http://localhost:8000/api/tts/generate \
  -H "Content-Type: application/json" \
  -d '{"text": "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–∞—Å", "filename": "special_offer"}'
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: TTS —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω

```bash
docker logs phone-tts
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
INFO:     Started server process
INFO:     Uvicorn running on http://0.0.0.0:5000
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: API –¥–æ—Å—Ç—É–ø–Ω–æ

```bash
curl http://localhost:8000/api/tts/health
```

–û—Ç–≤–µ—Ç:
```json
{
  "status": "healthy",
  "piper": true,
  "model": true,
  "url": "http://tts-service:5000"
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
curl -X POST http://localhost:8000/api/tts/generate \
  -H "Content-Type: application/json" \
  -d '{"text": "–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ —Ç–µ—Å—Ç"}' | jq
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "filename": "tts_20250101_120000_abc123.wav",
  "path": "/audio/tts_20250101_120000_abc123.wav",
  "size": 44186,
  "text_length": 17
}
```

---

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
```
docker/
‚îú‚îÄ‚îÄ tts/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile           ‚Üê –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Piper TTS
‚îÇ   ‚îú‚îÄ‚îÄ tts_service.py       ‚Üê API —Å–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt     ‚Üê Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

docker/scripts/
‚îú‚îÄ‚îÄ campaign_manager.py      ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω—ã TTS endpoints)
‚îî‚îÄ‚îÄ requirements.txt         ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω httpx)

docker/scripts/static/
‚îú‚îÄ‚îÄ index.html               ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω TTS —Ä–∞–∑–¥–µ–ª)
‚îî‚îÄ‚îÄ js/app.js                ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω—ã TTS —Ñ—É–Ω–∫—Ü–∏–∏)

docker-compose.yml           ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω tts-service)
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: TTS –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker logs phone-tts

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker compose build --no-cache tts-service
docker compose up -d tts-service
```

### –ü—Ä–æ–±–ª–µ–º–∞: "TTS service unavailable" –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

**–ü—Ä–∏—á–∏–Ω–∞:** TTS —Å–µ—Ä–≤–∏—Å –µ—â–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∏ 2-3 –º–∏–Ω—É—Ç—ã, –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "Model not found"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
docker compose down
docker compose up --build tts-service -d
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ì–æ–ª–æ—Å –∑–≤—É—á–∏—Ç —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ/–º–µ–¥–ª–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ–ª–∏ `ru_RU-ruslan-medium`.
–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å –≤ `docker/tts/Dockerfile` –Ω–∞ –¥—Ä—É–≥—É—é:
- `ru_RU-denis-medium` - –º—É–∂—Å–∫–æ–π –≥–æ–ª–æ—Å
- `ru_RU-ruslan-medium` - —Ç–µ–∫—É—â–∏–π
- –î—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏: https://github.com/rhasspy/piper/blob/master/VOICES.md

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Browser)
       ‚Üì
Campaign Manager API (:8000)
       ‚Üì HTTP request
TTS Service (:5000)
       ‚Üì subprocess
Piper TTS (binary)
       ‚Üì
Audio File (.wav)
       ‚Üì
/audio volume (shared)
```

### –§–æ—Ä–º–∞—Ç –∞—É–¥–∏–æ
- **–§–æ—Ä–º–∞—Ç:** WAV
- **–ß–∞—Å—Ç–æ—Ç–∞:** 22050 Hz (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Piper)
- **–ö–∞–Ω–∞–ª—ã:** –ú–æ–Ω–æ
- **–ë–∏—Ç—Ä–µ–π—Ç:** 16-bit
- **–†–∞–∑–º–µ—Ä:** ~44-50 KB –Ω–∞ —Å–µ–∫—É–Ω–¥—É

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–°–∫–æ—Ä–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:** ~1-2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
- **–†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏:** ~100 MB
- **RAM –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** ~200-300 MB

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ TTS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
2. üîÑ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö
3. üìù –°–æ–∑–¥–∞–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
4. üéØ –ò—Å–ø–æ–ª—å–∑—É–π –≤ –∫–∞–º–ø–∞–Ω–∏—è—Ö

### –£–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

- **–†–∞–∑–Ω—ã–µ –≥–æ–ª–æ—Å–∞:** –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- **–†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏:** –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `--speed` –≤ Piper
- **–≠–º–æ—Ü–∏–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π
- **–ü—Ä–µ–¥–ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Piper TTS GitHub:** https://github.com/rhasspy/piper
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ–ª–æ—Å–∞:** https://github.com/rhasspy/piper/blob/master/VOICES.md
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://github.com/rhasspy/piper/blob/master/README.md

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

–û—Ç–∫—Ä–æ–π http://localhost:8000 –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥–æ–ª–æ—Å–∞.
